SELECT DISTINCT product_title FROM Products WHERE product_id NOT IN (SELECT products_product_id FROM Cart_products) ORDER by product_title ASC;
SELECT DISTINCT product_title FROM Products WHERE product_id NOT IN (SELECT products_product_id FROM Cart_products WHERE carts_cart_id IN (SELECT Carts_cart_id FROM "Order")) ORDER by product_title ASC;
SELECT DISTINCT product_title, COUNT(product_id) as kolvo FROM Products p JOIN Cart_products c ON p.product_id=c.products_product_id GROUP BY product_title ORDER by kolvo DESC LIMIT 10;
SELECT p.product_title, COUNT(o.order_id) AS orders_count FROM Products p JOIN Cart_products cp ON p.product_id = cp.products_product_id JOIN "Order" o ON cp.carts_cart_id = o.carts_cart_id WHERE o.Order_status_order_status_id = 4 GROUP BY p.product_title ORDER BY orders_count DESC LIMIT 10;
SELECT u.last_name, u.first_name, MAX(o.total) AS ord_tot FROM Users u JOIN Carts crt ON u.user_id = crt.users_user_id JOIN "Order" o ON crt.cart_id = o.carts_cart_id WHERE o.Order_status_order_status_id = 4 OR o.Order_status_order_status_id = 3 OR o.Order_status_order_status_id = 2 GROUP BY u.user_id, u.last_name, u.first_name ORDER BY ord_tot DESC LIMIT 5;
SELECT u.last_name, u.first_name, COUNT(o.total) AS ord_count From Users u JOIN Carts crt ON u.user_id = crt.users_user_id JOIN "Order" o ON crt.cart_id = o.carts_cart_id WHERE o.Order_status_order_status_id = 4 OR o.Order_status_order_status_id = 3 OR o.Order_status_order_status_id = 2 GROUP BY u.user_id, u.last_name, u.first_name ORDER BY ord_count DESC LIMIT 5;
